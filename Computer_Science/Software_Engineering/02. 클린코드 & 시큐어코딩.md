## 클린코드

### 면접기출으로는 클린코드 규칙 자체에 대해 물어보기보다는, 인성관련내용으로 질문함.

- 팀에서 클린코드, 코드리뷰 등 아무것도 진행하지 않는다면 어떻게 할 것인가?

### 💡 의도를 분명히 밝혀라

- 변수, 함수, 클래스 등의 이름은 코드의 의도를 잘 표현할 수 있도록 지어야 하며, 이름만으로도 코드가 하는 일을 예측할 수 있도록 해야 한다.
- 의미 없는 약어나 애매한 이름을 피하고, 코드의 기능을 정확하게 반영하는 이름을 선택하는 것이 중요하다.

  ```js
  // 나쁜 예
  boolean flag = true;

  // 좋은 예
  boolean isUserLoggedIn = true;
  ```

### 💡 조건을 캡슐화하라

- 조건의 의도를 분명히 밝히는 함수로 표현하자.

  ```js
  // 나쁜 예
  //직원에게 복지 혜택을 받을 자격이 있는지 검사한다.
  if ((employee. flags & HOURLY_FLAG) && (employee.age > 65))

  // 좋은 예
  if (employee.isEligibleForFullBenefits())
  ```

### 💡 객체 생성에 유의미한 이름을 사용하라

- 객체의 생성자를 오버로딩 하는 경우 어떤 값으로 어떻게 생성되는지 정보가 부족할 수 있다.
- 이런 경우, 인수를 설명하는 이름으로 작성하는 것이 명확하다.

  ```js
  // 두 번째 인자가 무엇인지 파악이 어렵다.
  Student student = new Student("James", 85);

  // 이름을 부여하여 두 번째 인자를 명확하게 파악할 수 있다.
  Student student = Student.withGrade("James", 85);
  ```

### 💡 서술적인 이름을 사용하라

#### 서술적인 이름을 사용하면 개발자 머릿속에서도 설계가 뚜렷해지므로 코드를 개선하기 쉬워진다.

- 함수가 작고 단순할수록 서술적인 이름을 작성하기 쉬워진다.
- 이름이 길어도 괜찮다. 길고 서술적인 이름이 짧고 어려운 이름보다 좋다.
- 이름을 붙일 때는 일관성이 있어야 한다.
  모듈 내에서 함수 이름은 같은 문구, 명사, 동사를 사용하자.

### 💡 명령과 조회를 분리하라 (CQS 원칙)

- 함수는 뭔가를 수행하거나 뭔가를 조회하거나 하나의 역할만을 해야 한다.두 개의 역할을 동시에 하면 혼란을 초래한다.

  ```js
  public boolean set(String attribute, String value);
  if(set("username", "coco")) {
      ...
  }
  ```

  > 위 예시 코드를 보면, "username"이 "coco"로 설정되어 있는지를 확인하는 건지 "username"을 "coco"로 설정하는 코드인지 알 수 없다.  
  > 그 이유는 위의 함수가 명령과 조회를 한 번에 처리하기 때문이다.  
  > 조회와 명령을 분리하여 다음과 같이 작성해 주는 것이 명확하다.

  ```js
  public boolean attributeExists(String attribute);
  public boolean set(String attribute, String value);
  if(attributeExists("username")) {
      set("username", "coco");
      }
  ```

### 💡 오류 코드보단 예외를 사용하라 (많은 논란이 있는 주제 !)

- 오류 코드를 반환하면 그에 따른 분기가 생기고, 또 분기가 필요한 경우엔 중첩되기 마련이다.

### 💡 설계의 품질을 높여주는 4가지 규칙

1. 모든 테스트를 실행하라 : 테스트가 쉬운 코드를 만들다 보면 SRP를 준수하고, 낮은 결합도를 갖는 설계를 얻을 수 있다.
2. 중복을 제거하라 : 깔끔한 시스템을 만들기 위해 단 몇 줄이라도 중복을 제거해야 한다.
3. 개발자의 의도를 표현하라 : 좋은 이름, 클래스와 함수의 작은 크기, 표준 명칭, 단위 테스트 작성을 통해 이를 달성할 수 있다.
4. 클래스와 메소드의 수를 최소로 줄여라 : 클래스와 메소드를 작게 유지함으로써 시스템의 크기 역시 작게 유지할 수 있다.

> 2~4번은 리팩토링 과정에 해당한다.
> 모든 테스트케이스를 작성한 후에 코드를 정리하기 때문에 안전하다.
> 이 단계에선 소프트웨어 설계 품질을 높이는 기법이라면 무엇이든 적용해도 괜찮다.

### 💡 디미터 법칙

- 디미터의 법칙은 어떤 모듈이 호출하는 객체의 속사정을 몰라야 한다는 것이다.
- 객체는 자신의 내부 구조를 숨기고 함수를 통하여 기능을 공개해야 한다.
- 만약 객체의 내부 구조를 그대로 노출하면 다른 모듈은 객체의 내부 구조를 알게 되며 이로 인해 결합도가 높아지게 된다.

### 💡 테스트 코드

- TDD(Test-Driven Development)는 실제 코드를 짜기 전에 단위 테스트를 먼저 작성하는 기법으로 이를 통해 유연성, 유지보수성, 재사용성을 제공받는다.  
<br>
  #### TDD의 핵심 규칙 3가지는 다음과 같다.

  1. 실패하는 단위 테스트를 작성할 때까지 실제 코드를 작성하지 않는다.
  2. 컴파일은 실패하지 않으면서 실행이 실패하는 정도로만 단위 테스트를 작성한다.
  3. 실패하는 테스트를 통과할 정도로만 실제 코드를 작성한다.   
     테스트 코드가 없다면 실제 코드를 변경할 때 잠정적인 버그가 발생할 수 있음을 내포하지만, 테스트 코드가 있다면 변경된 코드를 검증함으로써 이를 해결할 수 있다.  
     그리고 실제 코드가 변경되면 테스트 코드 역시 변경 해주어야 하는데, 이러한 이유로 테스트 코드 역시 가독성 있게 작성하는 것이 중요하다.  
<br>
  - **테스트 코드를 작성할 때에는 다음 내용을 준수하는 것이 좋다.**  

  1. 테스트 함수 하나당 한 개념만을 테스트하라.  
  2. 한 개념 당 assert문의 수를 최소화하라.  
<br>
  - **또한, 깨끗한 테스트 코드는 F.I.R.S.T라는 5가지 규칙을 따른다.**

  1. Fast : 테스트는 빠르게 동작해야 한다.  
  2. Independent : 각 테스트는 서로 의존해선 안되며, 독립적으로 그리고 아무 순서로 실행해도 괜찮아야 한다.  
  3. Repeatable : 테스트는 어떤 환경에서도 반복 가능해야 한다.  
  4. Self-Validating : 테스트는 성공 또는 실패로 bool 값으로 결과를 내어 검증해야 한다.  
  5. Timely : 테스트는 적시에 즉, 테스트하려는 실제 코드를 구현하기 직전에 구현해야 한다.  

### 💡 변경하기 쉬운 클래스

- 요구사항은 수시로 변할 수 있다. 그렇기 때문에 변경하기 쉬운 클래스를 만드는 것은 중요하다.  
- 변경하기 쉬운 클래스는 기본적으로 단일 책임 원칙을 지켜야 한다.  

### 💡 적절한 추상화 수준에서 이름을 선택하라

- 적절한 이름 선택은 코드의 가독성과 유지보수성을 크게 영향을 미치는 요소이다.  
- 구현 세부사항을 드러내는 이름보다는 작업 대상 클래스나 함수가 위치하는 추상화 수준을 반영하는 이름을 선택하는 것이 중요하다.  

<hr>

## 시큐어 코딩

#### 👉 정의

> **시큐어 코딩은 사이버 공격에 대한 방어뿐만 아니라, 개발자의 실수나 코드상의 논리적 오류로 인해 발생할 수 있는 문제점을 사전에 차단 및 대응하는 내용도 포함되어 있다.**    
> 즉 소프트웨어의 가용성과 신뢰성이 위협받는 취약점은 모두 보안의 대상으로 정의한 것이다.  

- **소프트웨어 보안 취약점은 일반적으로 다음과 같은 경우에 자주 발생합니다.**
  1. 소프트웨어 요구 사항 정의 시에 아예 보안 요구사항을 고려하지 않았다.
  2. 소프트웨어가 논리적인 오류를 포함한 채로 설계되고 개발되었다.
  3. 기술적 취약점을 보완하지 않은 코딩 규칙을 적용하여 코딩했다.
  4. 발견된 취약점에 대해 적절한 관리 또는 패치를 제때 수행하지 않았다.

#### 시큐어 코딩, 어떻게 수행할 것인가?

1.  입력 데이터 검증 및 표현
    > 폼(form) 양식의 입력란에 입력되는 데이터로 인해 발생하는 문제를 예방하기 위한 보안 항목.  
    > 비정상적인 데이터를 입력하여 시스템에 손상을 주거나, 정보를 수정 및 탈취하지 못하도록 방지.  
    > 대표적으로 SQL 인젝션(SQL Injection) 공격을 막기 위한 코딩을 예로 들 수 있다.  
    > SQL(Structured Query Language)은 DB 관리에서 가장 중요한 핵심 요소로, 실제 저장된 데이터를 수정, 삭제, 삽입할 수 있는 기능이 있다.  
    > 이에 사용자가 입력한 데이터를 확인하여, 공격 시도로 의심되는 단어를 치환하거나 차단하는 방식을 이용한다.

- 또한 입력되는 데이터의 검증을 제대로 수행하지 않아, SQL 인젝션 공격에 취약한 예시 코드를 보자구 ~

  - 데이터베이스와 연동된 웹 응용프로그램에서 입력된 데이터에 대한 유효성 검증을 하지 않는다면, 공격자가 입력한 SQL 구문을 코드가 걸러내지 못한다.
  - 이는 데이터베이스로부터 정보를 열람하거나 조작할 수 있는 보안 취약점을 만들 수 있다.

  ```py
  from django.shortcuts import render

  def update_board(request):
      ......
      with dbconn.cursor() as curs:
          # 외부로부터 입력받은 값을 검증 없이 사용할 경우 안전하지 않다.
          name = request.POST.get('name', '')
          content_id = request.POST.get('content_id', '')

          # 사용자의 검증되지 않은 입력으로 부터 동적으로 쿼리문 생성
          sql_query = "update board set name='" + name + "' where content_id='“ + content_id + "'"
          # 외부 입력값이 검증 없이 쿼리로 수행되어 안전하지 않다.
          curs.execute(sql_query)
          curs.commit()
          return render(request, '/success.html')
  ```

  - 예제 코드에서 content_id 값으로 ‘a’ or ‘a’ = ‘a'와 같은 공격 문자열을 입력하면 조건절이 content_id = ‘a’ or ‘a’ = ‘a’로 바뀌고, 그 결과 board 테이블 전체 레코드의 name 칼럼이 공격자로부터 입력받은 name의 값으로 변경된다.

  ```py
  from django.shortcuts import render

  def update_board(request):
      ......
      with dbconn.cursor() as curs:
          name = request.POST.get('name', '')
          content_id = request.POST.get('content_id', '')

          # 외부 입력값으로 부터 안전한 매개 변수화된 쿼리를 생성 한다.
          sql_query = 'update board set name=%s where content_id=%s'
          # 사용자의 입력 값을 매개변수로 지정된 쿼리에 바인딩하여 실행되므로 안전하다.
          curs.execute(sql_query, (name, content_id))
          curs.commit()
          return render(request, '/success.html')
  ```
